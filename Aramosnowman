<html>
  <head>
    <style>
      body{ margin : 0; }
      canvas { width: 100%; height: 100% }
    </style>
  </head>
  <body>
    <script src = "three.min.js"></script>
    <script>
      var renderer = new THREE.WebGLRenderer({antialias:true});
      renderer.setSize( window.innerWidth, window.innerHeight );
      renderer.setClearColor( 0x000066 );
      document.body.appendChild( renderer.domElement );

      var scene = new THREE.Scene();

      var camera = new THREE.PerspectiveCamera( 40, window.innerWidth/window.innerHeight, 0.1, 1000 );
      camera.position.set( 3, 3, 10 );
      camera.lookAt( new THREE.Vector3( 0, 0, 0));

      //body-----------------------------------------------------------------
      function Body( size, x, y, z, color )
      {
        var geometry = new THREE.SphereGeometry( size, 32, 32);
        var material = new THREE.MeshPhongMaterial( {color: color} );
        var sphere = new THREE.Mesh( geometry, material );
        sphere.position.set( x, y, z );
        return sphere;
      }
      var sphere1 = Body( 1, 0, -1.5, 0, 'white' );
      scene.add( sphere1 );

      var sphere2 = Body( 0.8, 0, 0, 0, 'white' );
      scene.add( sphere2 );

      var sphere3 = Body( 0.6, 0, 1.2, 0, 'white' );
      scene.add( sphere3 );
      //hands--------------------------------------------------------------------
      var leftarm = new THREE.Object3D();
      scene.add ( leftarm );

      function Hands( size1, size2, size3, x, y, z, color )
      {
        var geometry = new THREE.BoxGeometry( size1, size2, size3 );
        var material = new THREE.MeshPhongMaterial( {color:color} );
        var hand = new THREE.Mesh( geometry, material );
        hand.position.set( x, y, z );
        return hand;
      }
      var lefthand = Hands( 1.5, 0.1, 0.1, 1.2, 0.7, 0, 0x663300 );
      lefthand.rotation.z = 0.5;
      leftarm.add( lefthand );

      var geometry = new THREE.BoxGeometry( 0.3, 0.075, 0.075 );
      var finger1 = Hands( 0.3, 0.075, 0.075, 1.8, 1.25, 0, 0x663300 );
      finger1.rotation.z = 1.9;
      leftarm.add( finger1 );

      var finger2 = Hands( 0.3, 0.075, 0.075, 1.95, 1.25, 0, 0x663300 );
      finger2.rotation.z = 1.1;
      leftarm.add( finger2 );

      var finger3 = Hands( 0.3, 0.075, 0.075, 2.06, 1.1, 0, 0x663300 );
      finger3.rotation.z = 0.1;
      leftarm.add( finger3 );

      var finger4 = Hands( 0.3, 0.075, 0.075, 2, 0.93, 0, 0x663300 );
      finger4.rotation.z = -0.8;
      leftarm.add( finger4 );

      var leftpalm = Body( 0.15, 1.88, 1.085, 0, 0x663300 );
      leftarm.add( leftpalm );

      var rightarm = new THREE.Object3D();
      scene.add ( rightarm );

      var righthand = Hands( 1.5, 0.1, 0.1, -1.2, 0.7, 0, 0x663300 );
      righthand.rotation.z = -0.5;
      rightarm.add( righthand );

      var finger5 = Hands( 0.3, 0.075, 0.075, -2, 1.25, 0, 0x663300 );
      finger5.rotation.z = 2.6;
      rightarm.add( finger5 );

      var finger6 = Hands( 0.3, 0.075, 0.075, -2.03, 1.2, 0, 0x663300 );
      finger6.rotation.z = 2.6;
      rightarm.add( finger6 );

      var finger7 = Hands( 0.3, 0.075, 0.075, -2.06, 1.15, 0, 0x663300 );
      finger7.rotation.z = 2.6;
      rightarm.add( finger7 );

      var finger8 = Hands( 0.3, 0.075, 0.075, -2.09, 1.1, 0, 0x663300 );
      finger8.rotation.z = 2.6;
      rightarm.add( finger8 );

      var rightpalm = Body( 0.15, -1.88, 1.085, 0, 0x663300 );
      rightarm.add( rightpalm );
      //eyes:----------------------------------------------------------------------
      var eye1 = Body( 0.1, 0.46, 1.48, 0.6, 'black' );
      scene.add( eye1 );

      var eye2 = Body( 0.1, 0, 1.44, 0.6, 'black' );
      scene.add( eye2 );
      //mouth:----------------------------------------------------------------
      var mouth = new THREE.Object3D();
      scene.add( mouth );

      var mouth1 = Body( 0.03, 0, 1.04, 0.6, 'black' );
      mouth.add( mouth1 );

      var mouth2 = Body( 0.03, 0.08, 1.02, 0.6, 'black' );
      mouth.add( mouth2 );

      var mouth3 = Body( 0.03, 0.16, 1, 0.6, 'black' );
      mouth.add( mouth3 );

      var mouth4 = Body( 0.03, 0.24, 0.99, 0.6, 'black' );
      mouth.add( mouth4 );

      var mouth5 = Body( 0.03, 0.32, 1, 0.6, 'black' );
      mouth.add( mouth5 );

      var mouth6 = Body( 0.03, 0.4, 1.02, 0.6, 'black' );
      mouth.add( mouth6 );

      var mouth7 = Body( 0.03, 0.48, 1.05, 0.6, 'black' );
      mouth.add( mouth7 );

      var mouth8 = Body( 0.03, 0.56, 1.09, 0.6, 'black' );
      mouth.add( mouth8 );
      //nose:-----------------------------------------------------------
      var nose = Body( 0.09, 0.235, 1.25, 0.6, 0xFF6600 );
      scene.add( nose );
      //buttons:-------------------------------------------------------------
      var button1 = Body( 0.05, 0.25, 0.5, 0.6, 'black' );
      scene.add( button1 );

      var button2 = Body( 0.05, 0.29, 0.18, 0.7, 'black' );
      scene.add( button2 );

      var button3 = Body( 0.05, 0.3, -0.14, 0.71, 'black' );
      scene.add( button3 );
      //cap:---------------------------------------------------------------
      function Hood( size1, size2, size3, x, y, z, color )
      {
        var geometry = new THREE.CylinderGeometry( size1, size2, size3 );
        var material = new THREE.MeshPhongMaterial( {color:color} );
        var cap = new THREE.Mesh( geometry, material );
        cap.position.set( x, y, z );
        return cap;
      }
      var cap1 = Hood( 0.6, 0.6, 1, 0.025, 2.2, 0, 'black' );
      scene.add( cap1 );

      var geometry = new THREE.TorusGeometry( 0.65, 0.1, 32, 32 );
      var material = new THREE.MeshPhongMaterial();
      var cap = new THREE.Mesh( geometry, material );
      cap.position.set( 0.025, 1.65, 0 );
      cap.rotation.x = 1.5;
      material.color.set( 'black' );
      scene.add( cap );
      //Table---------------------------------------------------------------
      var table1 = Hands( 3, 1.5, 0.1, -5.5, 1.5, 0, 'red' );
      table1.rotation.y = 1;
      scene.add( table1 );

      var table2 = new THREE.Mesh( new THREE.BoxGeometry( 2.7, 1.2, 0.11 ) );
      table2.rotation.y = 1;
      table2.position.set( -5.5, 1.5, 0);
      scene.add( table2 );
      var texture = new THREE.TextureLoader().load( "merry-christmas.jpg" );
      table2.material = new THREE.MeshPhongMaterial( {map: texture} );

      var holder1 = Hood( 0.1, 0.1, 3, -6.3, -0.7, 1.15, 'white' );
      holder1.rotation.y = 1;
      scene.add( holder1 );

      var holder2 = Hood( 0.1, 0.1, 3, -4.84, -0.7, -1.3, 'white' );
      holder2.rotation.y = 1;
      scene.add( holder2 );
      //snowfalls-----------------------------------------------------------------
      var N = 5000; // брой
			var pnts = new THREE.Geometry();
			for (var i=0; i<N; i++)
				pnts.vertices.push(new THREE.Vector3(250*Math.random()-125,250*Math.random()-125,250*Math.random()-125));
			var texture = new THREE.TextureLoader().load('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAEcSURBVHjapJPbjsIwDETTkga6XIXY///DFffShrbY7LFkISQesDSK2niciT0pxnGsQggTQQUSaxSU4T8GwV2QBR2roo+QlTQVzAQ1a2JPo4d4EzSshf6LnKbkH8FCsBTMKVJRIEO6CE5O2WgFZpA3YE2RRGIH+eBUDXaFhOwl5J1gK1ihTKMVHJ2i3vrgFcw5Wcm/FKshNK6YXeeq/yPdTq7ICvL2pYApObsmRxvVxI1wCrGmsRY1ezZm5ZRl+DKiddOZpEVy4/Lsu3VGUs4QcVjn5nx0DfM92LN3IVc59/hikoMbVftmjH/kWJHnGDtOODmTZLr9zkh7chuzsikonUluH6x89goyD8PsmTHJp8ek18qFPOevxvgQYABAeHG5NhljigAAAABJRU5ErkJggg==');
			var mtrl = new THREE.PointsMaterial({color:'white',size:3,map:texture,transparent: true,depthWrite: false});
			var snow = new THREE.Points(pnts,mtrl);
			scene.add(snow);

      var light = new THREE.PointLight();
      light.position.set( 3, 4, 5 );
      scene.add( light );

      var light = new THREE.PointLight();
      light.position.set( 3, -4, 0 );
      scene.add( light );

      var t = 0;
      var m = 0;
      function drawFrame()
      {
        requestAnimationFrame( drawFrame );
        m += 0.02;
        t++;
        leftarm.rotation.z = 0.3*Math.cos(3.5*m);
        mouth.position.x = -0.045;
        for (var i=0; i<N; i++)
				{
					var v = pnts.vertices[i];
					v.x += 0.1*Math.sin(i/30+t/40);
					v.z += 0.1*Math.cos(i/50+t/20);
					v.y -= 0.1*Math.cos(i/150+t/70)+0.2;
					if (v.y<-25) v.y+=100; // ако е под земята, пускаме я отгоре
				}
				pnts.verticesNeedUpdate = true
        renderer.render( scene, camera );
      }
      drawFrame();
    </script>
  </body>
</html>
